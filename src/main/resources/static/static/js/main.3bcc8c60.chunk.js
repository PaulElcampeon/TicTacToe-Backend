(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{12:function(e,t,n){},25:function(e,t,n){e.exports=n(35)},30:function(e,t,n){},35:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),o=n(21),s=n.n(o),r=(n(30),n(5)),c=n(6),l=n(8),u=n(7),m=n(9),d=(n(12),n(14)),h=n(10),p=function(e){function t(){var e;return Object(r.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).setRedirect=function(){e.setState({redirect:!0})},e.renderRedirectToGamePage=function(){if(e.state.redirect&&0!==e.portNo)return a.a.createElement(h.a,{to:{pathname:"/game",port:e.portNo}})},e.getPortNo=function(){fetch("/port").then(function(e){return e.text()}).then(function(t){e.portNo=t})},e.portNo=0,e.state={redirect:!1},e}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return a.a.createElement("div",{className:"text-white mainDiv"},this.getPortNo(),this.renderRedirectToGamePage(),a.a.createElement("h1",{className:"text-white mt-5 titleTextSize specialFont"},"Tic Tac Toe"),a.a.createElement("button",{className:"textSize btnCs m-auto p-4 btnTextSize specialFont",onClick:this.setRedirect},"PLAY"))}}]),t}(i.Component),b=function(e){function t(){var e;return Object(r.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).state={dotCounter:"."},e}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return a.a.createElement("div",{className:"mainDiv"},a.a.createElement("h1",{className:"m-auto waitingTextSize specialFont"},"Finding another player ",this.state.dotCounter))}},{key:"componentDidMount",value:function(){var e=this;this.myInterval=setInterval(function(){e.state.dotCounter.length>6?e.setState({dotCounter:"."}):e.setState({dotCounter:e.state.dotCounter+"."})},1e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.myInterval)}}]),t}(i.Component),f=function(e,t){return{x:e,y:t}},g=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).renderBoard=function(){n.mounted&&(n.sortOutBoardSize(),n.canvas.removeEventListener("click",n.clicky),n.ctx.clearRect(0,0,n.canvasWidth,n.canvasHeight),n.props.board.blocks.forEach(function(e,t){n.ctx.beginPath(),n.ctx.lineWidth="6",n.ctx.strokeStyle="white",n.ctx.rect(n.blockPositions[t].x,n.blockPositions[t].y,n.blockWidth,n.blockHeight),n.ctx.fillStyle="red",n.ctx.fill(),n.ctx.stroke(),n.ctx.beginPath(),n.ctx.font="30px Comic Sans MS",n.ctx.fillStyle="white",n.ctx.textAlign="center",n.ctx.fillText(n.renderCorrectSign(e.blockState),n.blockPositions[t].x+n.blockWidth/2,n.blockPositions[t].y+n.blockHeight/2)}),n.canvas.addEventListener("click",n.clicky))},n.clicky=function(e){n.props.board.blocks.forEach(function(t,i){e.offsetY>n.blockPositions[i].y&&e.offsetY<n.blockPositions[i].y+n.blockHeight&&e.offsetX>n.blockPositions[i].x&&e.offsetX<n.blockPositions[i].x+n.blockWidth&&"EMPTY"===t.blockState&&n.props.whosTurn===n.props.name&&n.props.sendBoardAction({playerName:n.props.name,gameId:n.props.gameId,blockNo:i})})},n.handleResize=function(){return n.setState({windowHeight:window.innerHeight,windowWidth:window.innerWidth})},n.sortOutBoardSize=function(){n.canvas.width=n.getSmallestSize()-50,n.canvas.height=n.getSmallestSize()-50,n.canvasWidth=n.canvas.width,n.canvasHeight=n.canvas.height,n.blockWidth=n.canvasWidth/3,n.blockHeight=n.canvasHeight/3,n.blockPositions=[];for(var e=0;e<3;e++)for(var t=0;t<3;t++)n.blockPositions.push(f(n.blockWidth*t,n.blockHeight*e))},n.getSmallestSize=function(){var e=n.state.windowHeight<n.state.windowWidth?n.state.windowHeight:n.state.windowWidth;return e>630?550:e},n.getWhosTurn=function(){return n.props.whosTurn===n.props.name?"Your Turn":"Opponents Turn"},n.gameInformation=function(){return a.a.createElement("h1",{className:"text-white text-center mb-5 pb-5 titleTextSize specialFont"},n.getWhosTurn())},n.mounted=!1,n.state={windowHeight:window.innerHeight,windowWidth:window.innerWidth},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"renderCorrectSign",value:function(e){return"EMPTY"===e?"":"NOUGHT"===e?"O":"X"}},{key:"componentDidMount",value:function(){this.canvas=this.refs.canvas,this.ctx=this.canvas.getContext("2d"),this.ctx.clearRect(0,0,this.canvasWidth,this.canvasHeight),this.mounted=!0,this.renderBoard(),this.handleResize(),window.addEventListener("resize",this.handleResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize)}},{key:"render",value:function(){return a.a.createElement("div",{className:"m-auto"},this.gameInformation(),a.a.createElement("canvas",{ref:"canvas",width:500,height:500}),this.renderBoard())}}]),t}(i.Component),S=n(24),w=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).subscribeToNewGameSession=function(){n.gameSessionSubscription=n.stompClient.subscribe("/topic/"+n.state.gameSession.gameId,function(e){if("GAMESESSION"===JSON.parse(e.body).messageType){var t=JSON.parse(e.body);"ENDED"===t.gameState?(null===t.winner?(n.winner=null,n.noWinner=!0):(n.noWinner=!1,n.winner=t.winner),n.setGameSessionToState(null)):n.setGameSessionToState(JSON.parse(e.body))}else"DISCONNECT"===JSON.parse(e.body).messageType&&(n.playerDisconnected=!0,n.winner=null,n.noWinner=!1,n.setGameSessionToState(null))})},n.joinGame=function(){n.stompClient.publish({destination:"/app/join",body:JSON.stringify({playerName:n.name})})},n.showLoading=function(){if(null==n.state.gameSession&&null===n.winner&&!1===n.noWinner&&!1===n.playerDisconnected)return a.a.createElement(b,null)},n.renderBoard=function(){if(null!=n.state.gameSession)return a.a.createElement(g,{name:n.name,whosTurn:n.state.gameSession.whosTurn,gameId:n.state.gameSession.gameId,board:n.state.gameSession.board,sendBoardAction:n.sendBoardAction})},n.sendBoardAction=function(e){n.stompClient.publish({destination:"/app/act/"+n.state.gameSession.gameId,body:JSON.stringify(e)})},n.winnerMessage=function(){if(null!=n.winner)return a.a.createElement("div",null,a.a.createElement("h1",{className:"text-white mt-5 titleTextSize specialFont"},n.returnWinnerName()),a.a.createElement("br",null),a.a.createElement("button",{className:"textSize btnCs m-auto p-4 btnTextSize specialFont",onClick:n.playAgain},"Play Again"))},n.noGameWinnerMessage=function(){if(n.noWinner)return a.a.createElement("div",null,a.a.createElement("h1",{className:"text-white mt-5 titleTextSize specialFont"},"No Winner"),a.a.createElement("br",null),a.a.createElement("button",{className:"textSize btnCs m-auto p-4 btnTextSize specialFont",onClick:n.playAgain},"Play Again"))},n.returnWinnerName=function(){return n.winner===n.name?"You Win":"You Lost"},n.showOtherPlayerDisconnectedMessage=function(){if(n.playerDisconnected)return a.a.createElement("div",null,a.a.createElement("h1",{className:"text-white mt-5 titleTextSize specialFont"},"Other player disconnected from game"),a.a.createElement("br",null),a.a.createElement("button",{className:"textSize btnCs m-auto p-4 btnTextSize specialFont",onClick:n.playAgain},"Play Again"))},n.playAgain=function(){n.playerDisconnected=!1,n.winner=null,n.noWinner=!1,n.setGameSessionToState(null),n.joinGame()},n.setGameSessionToState=function(e){n.setState({gameSession:e})},n.setConnectedState=function(e){n.setState({connected:e})},n.startAutomatedMessages=function(){n.myInterval=setInterval(function(){n.stompClient.publish({destination:"/topic/empty",body:""})},5e4)},n.name="",n.winner=null,n.noWinner=!1,n.playerDisconnected=!1,n.gameSessionSubscription=null,n.state={connected:!1,gameSession:null},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"createStompClient",value:function(){this.state.connected||(this.stompClient=new S.Client({brokerURL:"ws://localhost:"+this.props.location.port+"/ticTacToe",debug:function(e){}}),this.connect())}},{key:"connect",value:function(){var e=this;this.stompClient.onConnect=function(t){e.name=t.headers.name,e.privateSubscription=e.stompClient.subscribe("/queue/"+e.name,function(t){e.setGameSessionToState(JSON.parse(t.body)),null!==e.gameSessionSubscription?(e.gameSessionSubscription.unsubscribe(),e.subscribeToNewGameSession()):e.subscribeToNewGameSession(),t.ack()}),e.joinGame(),e.startAutomatedMessages(),e.setConnectedState(!0)},this.stompClient.onStompError=function(e){console.log("Broker reported error: "+e.headers.message),console.log("Additional details: "+e.body)},this.stompClient.activate()}},{key:"componentWillUnmount",value:function(){clearInterval(this.myInterval)}},{key:"render",value:function(){return a.a.createElement("div",{className:"text-white mainDiv"},this.createStompClient(),this.showLoading(),this.renderBoard(),this.winnerMessage(),this.noGameWinnerMessage(),this.showOtherPlayerDisconnectedMessage())}}]),t}(i.Component),v=function(){return a.a.createElement("div",null,a.a.createElement("h1",{className:"text-white mt-5 titleTextSize specialFont"},"Error"),a.a.createElement("br",null),a.a.createElement(d.b,{className:"text-white mt-5 waitingTextSize",to:"/"},"Back To Home Page"))},y=function(e){function t(){return Object(r.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return a.a.createElement(d.a,null,a.a.createElement(h.d,null,a.a.createElement(h.b,{path:["/","/home"],exact:!0,strict:!0,component:p}),a.a.createElement(h.b,{path:"/game",exact:!0,strict:!0,component:w}),a.a.createElement(h.b,{component:v})))}}]),t}(i.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(a.a.createElement(y,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[25,1,2]]]);
//# sourceMappingURL=main.3bcc8c60.chunk.js.map